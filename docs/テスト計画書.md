# 予約管理システム連携ツール テスト計画書

## 1. テスト概要

**対象システム**: 予約管理シート連携ツール  
**テスト期間**: 第5週〜第7週（3週間）  
**テスト環境**: 本番相当検証環境  
**テスト責任者**: XXXX

## 2. テスト区分と方針

| テスト区分 | 実施時期 | 目的 | 実施者 |
|----------|---------|------|-------|
| 単体テスト | 各機能実装後 | 個別機能の正常動作確認 | 開発担当者 |
| 結合テスト | 第5週 | 機能間連携の動作確認 | 開発担当者 |
| システムテスト | 第6週 | 全体フローとパフォーマンス検証 | テスト担当者 |
| ユーザー受入テスト(UAT) | 第7週 | 業務要件充足確認 | 利用部門担当者 |

## 3. テスト環境

### 3.1 ハードウェア環境

- テスト用クライアントPC: Windows 10/11 Pro
- メモリ: 8GB以上
- ストレージ: SSD 128GB以上
- ネットワーク: 社内LAN環境

### 3.2 ソフトウェア環境

- .NET Framework 4.8 / .NET 6.0以上
- Excel 2019以上
- Supabaseテスト環境（本番と同等スキーマ）
- LINE WORKS Botテスト環境

### 3.3 テストデータ

- 店舗データ: フェーズ1対象の3拠点（千葉・いいいい、埼京A2・ふふふふ、埼京B・みみみ）のExcelファイル
- 日付データ: 当日〜3ヶ月先までの予約データ
- 特殊パターン: 満室/空室/一部予約状態のバリエーション

## 4. テスト項目詳細

### 4.1 単体テスト項目

#### 4.1.1 ファイル監視機能 (F-1)

| ID | テスト項目 | 前提条件 | 手順 | 期待結果 | 判定基準 |
|----|----------|---------|------|---------|---------|
| UT-F1-01 | ファイル検出正常系 | テスト用Excelファイル配置済み | ファイル更新 → 監視機能実行 | 更新ファイルを正しく検出 | 変更ファイルリスト生成確認 |
| UT-F1-02 | ネットワークエラー | ネットワーク切断状態 | 監視機能実行 | エラーハンドリング、3回リトライ | エラーログ記録、リトライ確認 |
| UT-F1-03 | ファイル形式異常 | 不正なファイル配置 | 監視機能実行 | エラーハンドリング、スキップ | エラーログ記録、処理継続確認 |
| UT-F1-04 | 特定パスパターン確認 | 各拠点フォルダ構成 | 監視機能実行 | 各拠点ファイルを検出 | 3拠点ファイル検出確認 |

#### 4.1.2 データ抽出機能 (F-2)

| ID | テスト項目 | 前提条件 | 手順 | 期待結果 | 判定基準 |
|----|----------|---------|------|---------|---------|
| UT-F2-01 | CH列（夜間）抽出正常系 | 標準形式Excelファイル | 抽出機能実行 | CH列（夜間）データ正常抽出 | 抽出データの正確性確認 |
| UT-F2-02 | 日付範囲制限 | 広範囲データあるExcel | 抽出機能実行 | 当日〜2ヶ月先までのみ抽出 | 日付範囲の正確性確認 |
| UT-F2-03 | 非標準シート名 | シート名が異なるExcel | 抽出機能実行（設定変更） | 正しいシートからデータ抽出 | 設定変更反映確認 |

#### 4.1.3 差分判定機能 (F-3)

| ID | テスト項目 | 前提条件 | 手順 | 期待結果 | 判定基準 |
|----|----------|---------|------|---------|---------|
| UT-F3-01 | 新規レコード検出 | 前回データなし | 差分判定実行 | 全レコードを新規として検出 | 新規レコード数確認 |
| UT-F3-02 | 変更レコード検出 | 前回データあり+一部変更 | 差分判定実行 | 変更レコードのみ検出 | 変更内容の正確性確認 |
| UT-F3-03 | 削除レコード検出 | 前回データあり+一部削除 | 差分判定実行 | 削除レコードを検出 | 削除レコード特定確認 |

#### 4.1.4 データベース同期機能 (F-4)

| ID | テスト項目 | 前提条件 | 手順 | 期待結果 | 判定基準 |
|----|----------|---------|------|---------|---------|
| UT-F4-01 | Upsert正常系 | テスト用差分データ | DB同期実行 | レコード正常更新 | DB内容確認 |
| UT-F4-02 | DB接続エラー | DB接続不可状態 | DB同期実行 | エラーハンドリング、リトライ | エラーログ記録、リトライ確認 |
| UT-F4-03 | 一括更新性能 | 大量差分データ | DB同期実行 | 3分以内に処理完了 | 処理時間計測 |

#### 4.1.5 証跡生成機能 (F-5)

| ID | テスト項目 | 前提条件 | 手順 | 期待結果 | 判定基準 |
|----|----------|---------|------|---------|---------|
| UT-F5-01 | CSV出力正常系 | テスト用差分データ | 証跡生成実行 | CSV正常出力 | ファイル内容確認 |
| UT-F5-02 | 文字コード確認 | 特殊文字含むデータ | 証跡生成実行 | UTF-8(BOM付)で出力 | 文字コード確認 |
| UT-F5-03 | ディスク容量不足 | ディスク空き容量少 | 証跡生成実行 | エラーハンドリング | エラーログ記録確認 |

#### 4.1.6 通知機能 (F-6)

| ID | テスト項目 | 前提条件 | 手順 | 期待結果 | 判定基準 |
|----|----------|---------|------|---------|---------|
| UT-F6-01 | LINE通知正常系 | テスト用Bot設定済 | 通知機能実行 | メッセージ正常送信 | Bot受信確認 |
| UT-F6-02 | JWT認証エラー | 不正な認証情報 | 通知機能実行 | エラーハンドリング、リトライ | エラーログ記録確認 |
| UT-F6-03 | トークンキャッシュ | 複数回実行 | 通知機能連続実行 | トークン再利用確認 | API呼出回数確認 |

### 4.2 結合テスト項目

| ID | テスト項目 | 前提条件 | 手順 | 期待結果 | 判定基準 |
|----|----------|---------|------|---------|---------|
| IT-01 | 監視→抽出→差分連携 | テスト環境準備完了 | ファイル更新トリガー | 全プロセス正常実行 | 一連の処理フロー確認 |
| IT-02 | 差分→DB→証跡連携 | テスト用差分データ | 差分データ投入 | DB更新+証跡生成 | 処理連携の正確性確認 |
| IT-03 | 全機能連携テスト | テスト環境準備完了 | システム全体実行 | エンドツーエンド正常動作 | 全処理フロー確認 |

### 4.3 システムテスト項目

| ID | テスト項目 | 前提条件 | 手順 | 期待結果 | 判定基準 |
|----|----------|---------|------|---------|---------|
| ST-01 | 3拠点一括処理 | フェーズ1対象の3拠点データ準備 | システム実行 | 全拠点データ処理完了 | 処理完了・正確性確認 |
| ST-02 | パフォーマンステスト | 標準環境 | 大量データ処理 | 3分以内に処理完了 | 処理時間計測 |
| ST-03 | 長期安定性テスト | 標準環境 | 24時間連続実行 | エラーなく継続実行 | メモリリーク・安定性確認 |
| ST-04 | ネットワーク復旧テスト | ネットワーク断続環境 | システム実行 | 自動リカバリー確認 | 復旧プロセス確認 |
| ST-05 | 設定変更テスト | 複数設定パターン | 設定変更→実行 | 設定反映確認 | 動的設定反映確認 |

### 4.4 ユーザー受入テスト項目

| ID | テスト項目 | 前提条件 | 手順 | 期待結果 | 判定基準 |
|----|----------|---------|------|---------|---------|
| UAT-01 | 業務シナリオ検証 | 実データ相当準備 | 実運用想定フロー実行 | 業務要件充足確認 | 利用部門承認 |
| UAT-02 | LINE通知フォーマット | 実Bot環境接続 | システム実行 | 通知内容業務要件充足 | 利用部門承認 |
| UAT-03 | 証跡CSV確認 | 実データ相当準備 | システム実行 | CSV内容・形式確認 | 利用部門承認 |
| UAT-04 | 障害時運用確認 | 障害模擬環境 | 障害発生→復旧 | 運用手順有効性確認 | 運用部門承認 |
| UAT-05 | 運用マニュアル検証 | 運用マニュアル準備 | マニュアルに沿った操作 | マニュアル正確性確認 | 運用部門承認 |

## 5. 非機能要件テスト

### 5.1 性能テスト

| ID | テスト項目 | 条件 | 目標値 | 測定方法 |
|----|----------|------|-------|---------|
| PF-01 | 処理時間 | 3拠点一括処理 | 2分以内 | 処理開始〜終了時間計測 |
| PF-02 | CPU使用率 | 処理ピーク時 | 50%以下 | Windowsパフォーマンスモニター |
| PF-03 | メモリ使用量 | 処理ピーク時 | 2GB以下 | Windowsパフォーマンスモニター |
| PF-04 | ディスクI/O | 証跡ファイル生成時 | 10MB/s以下 | Windowsパフォーマンスモニター |
| PF-05 | ネットワーク | Supabase通信時 | 5Mbps以下 | ネットワークモニタリング |

### 5.2 信頼性テスト

| ID | テスト項目 | 条件 | 目標値 | 測定方法 |
|----|----------|------|-------|---------|
| RL-01 | 連続稼働 | 24時間連続運用 | エラーなし | 長時間実行監視 |
| RL-02 | 再起動復旧 | PC再起動後 | 自動復旧 | 再起動後の動作確認 |
| RL-03 | エラー復旧 | 各種エラー発生後 | 次回正常実行 | エラー注入テスト |
| RL-04 | データ整合性 | DB更新後 | 100%一致 | Excel/DB比較チェック |

### 5.3 セキュリティテスト

| ID | テスト項目 | 条件 | 目標値 | 測定方法 |
|----|----------|------|-------|---------|
| SC-01 | 認証情報保護 | 設定ファイル検査 | 平文なし | ファイル内容確認 |
| SC-02 | アクセス制限 | 無権限ユーザー | アクセス不可 | 権限テスト |
| SC-03 | ログ監査 | 操作ログ | 全操作記録 | ログファイル確認 |

## 6. テスト実施体制

### 6.1 役割分担

| 役割 | 担当者 | 責任範囲 |
|-----|-------|---------|
| テスト管理者 | XXX | テスト全体計画・進捗管理 |
| テスト実施者 | YYY | テスト実行・結果記録 |
| 品質保証担当 | ZZZ | 品質基準適合判定 |
| 利用部門 | AAA | UAT実施・業務要件確認 |

### 6.2 テスト手順書

各テスト項目に対する詳細手順書は別途「テスト手順書.xlsx」に記載

### 6.3 テスト結果報告

- テスト結果記録書（各フェーズ完了時）
- 不具合管理表（発見時随時更新）
- 最終テスト報告書（全テスト完了時）

## 7. テスト完了基準

| 区分 | 完了基準 |
|-----|---------|
| 単体テスト | 各機能の全テスト項目が合格 |
| 結合テスト | 全連携パターンが正常動作 |
| システムテスト | 全システムテスト項目が合格かつ性能要件充足 |
| UAT | 利用部門による全UAT項目の承認取得 |
| 全体 | すべての重大な不具合が解決済み |

## 8. リスクと対策

| リスク | 影響 | 対策 |
|-------|------|------|
| テスト環境の本番乖離 | テスト結果の信頼性低下 | 本番同等環境構築、データ移行テスト実施 |
| テストデータ不足 | 異常系検出漏れ | 境界値・特殊ケースを網羅的に準備 |
| スケジュール遅延 | リリース遅延 | テスト自動化、並行テスト実施 |
| 環境リソース不足 | テスト実行不能 | 事前リソース確保、クラウド環境活用 | 