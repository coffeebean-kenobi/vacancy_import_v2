[2025-07-21 16:48:43.626 +09:00 INF] 🚀 予約管理システム連携ツールを開始します (モード: Console) 
[2025-07-21 16:48:44.084 +09:00 INF] 📋 コンソールモードで実行を開始します 
[2025-07-21 16:48:44.132 +09:00 INF] イベントログサービスが初期化されました 
[2025-07-21 16:48:44.185 +09:00 INF] パフォーマンスモニタリングを開始しました (間隔: 60秒) 
[2025-07-21 16:48:44.206 +09:00 INF] 🚀 予約管理システム連携サービス の開始準備中... 
[2025-07-21 16:48:44.209 +09:00 INF] 🔍 設定の検証を開始します 
[2025-07-21 16:48:44.227 +09:00 ERR] Current configuration is invalid: Supabase Key cannot be empty 
[2025-07-21 16:48:44.236 +09:00 FTL] ❌ 設定の検証に失敗しました 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
[2025-07-21 16:48:44.269 +09:00 ERR] Hosting failed to start 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
   at VacancyImport.Services.ServiceHost.StartingAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 56
[2025-07-21 16:48:44.288 +09:00 FTL] ❌ アプリケーションが予期せず終了しました 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
   at VacancyImport.Services.ServiceHost.StartingAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 56
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>g__LogAndRethrow|14_3(<>c__DisplayClass14_0&)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at VacancyImport.Program.RunAsConsoleAsync(String[] args, IConfiguration configuration) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Program.cs:line 128
   at VacancyImport.Program.Main(String[] args) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Program.cs:line 45
[2025-07-21 16:54:41.731 +09:00 INF] 🚀 予約管理システム連携ツールを開始します (モード: Console) 
[2025-07-21 16:54:41.861 +09:00 INF] 📋 コンソールモードで実行を開始します 
[2025-07-21 16:54:41.884 +09:00 INF] イベントログサービスが初期化されました 
[2025-07-21 16:54:41.906 +09:00 INF] パフォーマンスモニタリングを開始しました (間隔: 60秒) 
[2025-07-21 16:54:41.931 +09:00 INF] 🚀 予約管理システム連携サービス の開始準備中... 
[2025-07-21 16:54:41.934 +09:00 INF] 🔍 設定の検証を開始します 
[2025-07-21 16:54:41.945 +09:00 ERR] Current configuration is invalid: Supabase Key cannot be empty 
[2025-07-21 16:54:41.955 +09:00 FTL] ❌ 設定の検証に失敗しました 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
[2025-07-21 16:54:41.978 +09:00 ERR] Hosting failed to start 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
   at VacancyImport.Services.ServiceHost.StartingAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 56
[2025-07-21 16:54:41.994 +09:00 FTL] ❌ アプリケーションが予期せず終了しました 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
   at VacancyImport.Services.ServiceHost.StartingAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 56
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>g__LogAndRethrow|14_3(<>c__DisplayClass14_0&)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at VacancyImport.Program.RunAsConsoleAsync(String[] args, IConfiguration configuration) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Program.cs:line 128
   at VacancyImport.Program.Main(String[] args) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Program.cs:line 45
[2025-07-21 16:56:14.975 +09:00 INF] 🚀 予約管理システム連携ツールを開始します (モード: Console) 
[2025-07-21 16:56:15.096 +09:00 INF] 📋 コンソールモードで実行を開始します 
[2025-07-21 16:56:15.117 +09:00 INF] イベントログサービスが初期化されました 
[2025-07-21 16:56:15.139 +09:00 INF] パフォーマンスモニタリングを開始しました (間隔: 60秒) 
[2025-07-21 16:56:15.161 +09:00 INF] 🚀 予約管理システム連携サービス の開始準備中... 
[2025-07-21 16:56:15.164 +09:00 INF] 🔍 設定の検証を開始します 
[2025-07-21 16:56:15.174 +09:00 ERR] Current configuration is invalid: Supabase Key cannot be empty 
[2025-07-21 16:56:15.184 +09:00 FTL] ❌ 設定の検証に失敗しました 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
[2025-07-21 16:56:15.201 +09:00 ERR] Hosting failed to start 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
   at VacancyImport.Services.ServiceHost.StartingAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 56
[2025-07-21 16:56:15.216 +09:00 FTL] ❌ アプリケーションが予期せず終了しました 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
   at VacancyImport.Services.ServiceHost.StartingAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 56
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>g__LogAndRethrow|14_3(<>c__DisplayClass14_0&)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at VacancyImport.Program.RunAsConsoleAsync(String[] args, IConfiguration configuration) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Program.cs:line 128
   at VacancyImport.Program.Main(String[] args) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Program.cs:line 45
[2025-07-21 17:00:42.703 +09:00 INF] 🚀 予約管理システム連携ツールを開始します (モード: Console) 
[2025-07-21 17:00:42.848 +09:00 INF] 📋 コンソールモードで実行を開始します 
[2025-07-21 17:00:42.871 +09:00 INF] イベントログサービスが初期化されました 
[2025-07-21 17:00:42.899 +09:00 INF] パフォーマンスモニタリングを開始しました (間隔: 60秒) 
[2025-07-21 17:00:42.921 +09:00 INF] 🚀 予約管理システム連携サービス の開始準備中... 
[2025-07-21 17:00:42.923 +09:00 INF] 🔍 設定の検証を開始します 
[2025-07-21 17:00:42.934 +09:00 ERR] Current configuration is invalid: Supabase Key cannot be empty 
[2025-07-21 17:00:42.946 +09:00 FTL] ❌ 設定の検証に失敗しました 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
[2025-07-21 17:00:42.981 +09:00 ERR] Hosting failed to start 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
   at VacancyImport.Services.ServiceHost.StartingAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 56
[2025-07-21 17:00:42.996 +09:00 FTL] ❌ アプリケーションが予期せず終了しました 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
   at VacancyImport.Services.ServiceHost.StartingAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 56
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>g__LogAndRethrow|14_3(<>c__DisplayClass14_0&)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at VacancyImport.Program.RunAsConsoleAsync(String[] args, IConfiguration configuration) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Program.cs:line 128
   at VacancyImport.Program.Main(String[] args) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Program.cs:line 45
[2025-07-21 17:01:13.568 +09:00 INF] 🚀 予約管理システム連携ツールを開始します (モード: Console) 
[2025-07-21 17:01:13.718 +09:00 INF] 📋 コンソールモードで実行を開始します 
[2025-07-21 17:01:13.740 +09:00 INF] イベントログサービスが初期化されました 
[2025-07-21 17:01:13.762 +09:00 INF] パフォーマンスモニタリングを開始しました (間隔: 60秒) 
[2025-07-21 17:01:13.786 +09:00 INF] 🚀 予約管理システム連携サービス の開始準備中... 
[2025-07-21 17:01:13.790 +09:00 INF] 🔍 設定の検証を開始します 
[2025-07-21 17:01:13.802 +09:00 ERR] Current configuration is invalid: Supabase Key cannot be empty 
[2025-07-21 17:01:13.813 +09:00 FTL] ❌ 設定の検証に失敗しました 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
[2025-07-21 17:01:13.847 +09:00 ERR] Hosting failed to start 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
   at VacancyImport.Services.ServiceHost.StartingAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 56
[2025-07-21 17:01:13.863 +09:00 FTL] ❌ アプリケーションが予期せず終了しました 
VacancyImport.Exceptions.ConfigurationException: Supabase Key cannot be empty
   at VacancyImport.Configuration.ConfigurationValidator.ValidateSupabaseSettings(SupabaseSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 57
   at VacancyImport.Configuration.ConfigurationValidator.ValidateAppSettings(AppSettings settings) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationValidator.cs:line 90
   at VacancyImport.Configuration.ConfigurationManager.ValidateCurrentConfiguration() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Configuration\ConfigurationManager.cs:line 63
   at VacancyImport.Services.ServiceHost.ValidateConfigurationAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 305
   at VacancyImport.Services.ServiceHost.StartingAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 56
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>g__LogAndRethrow|14_3(<>c__DisplayClass14_0&)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at VacancyImport.Program.RunAsConsoleAsync(String[] args, IConfiguration configuration) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Program.cs:line 128
   at VacancyImport.Program.Main(String[] args) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Program.cs:line 45
[2025-07-21 17:06:30.725 +09:00 INF] 🚀 予約管理システム連携ツールを開始します (モード: Console) 
[2025-07-21 17:06:30.868 +09:00 INF] 📋 コンソールモードで実行を開始します 
[2025-07-21 17:06:30.889 +09:00 INF] イベントログサービスが初期化されました 
[2025-07-21 17:06:30.910 +09:00 INF] パフォーマンスモニタリングを開始しました (間隔: 60秒) 
[2025-07-21 17:06:30.936 +09:00 INF] 🚀 予約管理システム連携サービス の開始準備中... 
[2025-07-21 17:06:30.942 +09:00 INF] 🔍 設定の検証を開始します 
[2025-07-21 17:06:30.953 +09:00 INF] ✅ 設定の検証が完了しました 
[2025-07-21 17:06:30.957 +09:00 INF] 📋 開始準備が完了しました 
[2025-07-21 17:06:30.963 +09:00 INF] 🔄 メインループを開始します (ポーリング間隔: 5分) 
[2025-07-21 17:06:30.968 +09:00 INF] 定期ヘルスチェックを開始します 
[2025-07-21 17:06:31.012 +09:00 INF] 定期ヘルスチェックが完了しました 
[2025-07-21 17:06:31.015 +09:00 INF] ✅ 予約管理システム連携サービス が正常に開始されました 
[2025-07-21 17:06:31.540 +09:00 INF] Application started. Press Ctrl+C to shut down. 
[2025-07-21 17:06:31.548 +09:00 INF] Hosting environment: Production 
[2025-07-21 17:06:31.555 +09:00 INF] Content root path: C:\VacancyImport 
[2025-07-21 17:06:38.709 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\【原本（共有なし）】2025年_SS予約表_250302.xlsm 
[2025-07-21 17:06:38.718 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\千葉\まつど\2025年_SS予約表_241122(使用していない).xlsm 
[2025-07-21 17:06:39.383 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\千葉\まつど\【まつど】2025年_SS予約表2_241122.xlsm 
[2025-07-21 17:06:40.067 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\千葉\いちかわ\【いちかわ】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:40.648 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\千葉\わかば\【わかば】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:41.266 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\千葉\やちよ\【やちよ】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:41.298 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A1\あだち\【あだち】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:42.098 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\千葉\寿クラブ\【寿クラブ】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:42.322 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A1\あだち\コピー【あだち】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:42.859 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A1\おおみや\【おおみや】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:43.594 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A1\みどり\【みどり】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:43.927 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A1\みどり\コピー【みどり】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:43.991 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A1\わらび\【わらび】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:45.052 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\いたばし\★【いたばし】2025年2025年2月1日から使用_SS予約表.xlsm 
[2025-07-21 17:06:45.715 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\さやま\2025年　2月～.xlsm 
[2025-07-21 17:06:45.827 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\さやま\【さやま】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:46.533 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\さやま\コピー2025年　2月～.xlsm 
[2025-07-21 17:06:46.725 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\しき\【しき】2025年_SS予約表_250111.xlsm 
[2025-07-21 17:06:47.190 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\にいざ\【にいざ】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:47.852 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\にいざ\コピー【にいざ】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:48.152 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\ねりま\【ねりま】2025年_SS予約表_241122　２.xlsm 
[2025-07-21 17:06:48.205 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\ねりま\コピー【ねりま】2025年_SS予約表_241122　２.xlsm 
[2025-07-21 17:06:48.309 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\ふじみの\【ふじみの】2025年_SS予約表_250111.xlsm 
[2025-07-21 17:06:49.745 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\ふじみの\コピー【ふじみの】2025年_SS予約表_250111.xlsm 
[2025-07-21 17:06:50.289 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京B\かわぐち\【かわぐち】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:50.618 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\わこう\【わこう】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:50.997 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\【こしがや】2025年_SS予約表_241122 のコピー.xlsm 
[2025-07-21 17:06:51.310 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\【こしがや】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:51.953 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京B\そうか\ss202504４.xlsm 
[2025-07-21 17:06:52.355 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京B\そうか\【そうか】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:52.700 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京B\そうか\コピー【そうか】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:53.555 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京B\みさと\【みさと】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:54.969 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\神奈川\かなざわ\【かなざわ】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:55.736 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\神奈川\たかつ\【たかつ】2025年_SS予約表_241122_bk.xlsm 
[2025-07-21 17:06:57.513 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\【やまと】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:57.655 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\神奈川\ふじさわ\【ふじさわ】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:06:58.822 +09:00 WRN] 処理時間が閾値を超えました: CalculateFileHash - 5260.5148ms (閾値: 5000ms) 
[2025-07-21 17:06:58.833 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\神奈川\つるみ\【つるみ】2025年_SS予約表_241122_bk.xlsm 
[2025-07-21 17:06:59.288 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\コピー【やまと】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:07:00.103 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\神奈川\よこすか\【よこすか】2025年_SS予約表_241122 最新.xlsm 
[2025-07-21 17:07:00.113 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\神奈川\よこすか\【よこすか】2025年_SS予約表のバックアップ_241122.xlsm 
[2025-07-21 17:07:00.666 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\千葉\いちかわ\過去\✕【いちかわ】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:07:01.875 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A1\おおみや\過去\【おおみや】2024年_SS予約表_231215.xlsm 
[2025-07-21 17:07:01.879 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\千葉\いちかわ\過去\【いちかわ】SS予約表_240507.xlsm 
[2025-07-21 17:07:02.156 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A1\おおみや\過去\【おおみや】2024年_SS予約表_240519.xlsm 
[2025-07-21 17:07:03.739 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A1\おおみや\ボード係\3.旧予約表\【おおみや】2024年_SS予約表_231215.xlsm 
[2025-07-21 17:07:03.743 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\にいざ\使用不可\✕【にいざ】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:07:05.322 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A2\ねりま\過去\✕【ねりま】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:07:05.427 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A1\おおみや\ボード係\3.旧予約表\【原本】SS予約表（3ユニット）.xlsm 
[2025-07-21 17:07:05.698 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A1\おおみや\ボード係\3.旧予約表\【おおみや】2024年_SS予約表_240519.xlsm 
[2025-07-21 17:07:06.551 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\埼京A1\おおみや\ボード係\3.旧予約表\【原本】SS予約表（3ユニット）_230303.xlsm 
[2025-07-21 17:07:25.221 +09:00 WRN] 処理時間が閾値を超えました: CalculateFileHash - 35927.0313ms (閾値: 5000ms) 
[2025-07-21 17:07:25.230 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.FileStreamHelpers.ChooseStrategyCore(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:07:25.254 +09:00 ERR] ファイル変更チェック中に1件のエラーが発生しました 
[2025-07-21 17:07:25.263 +09:00 WRN] エラーが発生しました。200ms後にリトライします (試行回数: 1/3) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.FileStreamHelpers.ChooseStrategyCore(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
[2025-07-21 17:07:25.503 +09:00 WRN] リトライ実行中 (試行回数: 1/3, 遅延: 400ms) 
[2025-07-21 17:07:29.293 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:07:30.680 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\神奈川\ふじさわ\【ふじさわ】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:07:30.957 +09:00 INF] システムリソース使用状況: メモリ=57MB, CPUタイム="00:00:02.8750000", スレッド数=14 
[2025-07-21 17:07:30.972 +09:00 INF] 操作パフォーマンス: CalculateFileHash, 平均=2579.3484924528307ms, 最大=35927.0313ms, 最小=58.202ms, 件数=53 
[2025-07-21 17:08:04.674 +09:00 WRN] 処理時間が閾値を超えました: CalculateFileHash - 35395.5038ms (閾値: 5000ms) 
[2025-07-21 17:08:04.685 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:08:04.697 +09:00 ERR] ファイル変更チェック中に2件のエラーが発生しました 
[2025-07-21 17:08:04.706 +09:00 WRN] エラーが発生しました。400ms後にリトライします (試行回数: 2/3) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に2件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.) (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に2件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.) (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
 ---> (Inner Exception #1) System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57<---

   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
[2025-07-21 17:08:05.154 +09:00 WRN] リトライ実行中 (試行回数: 2/3, 遅延: 800ms) 
[2025-07-21 17:08:09.061 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:08:09.071 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:08:09.111 +09:00 ERR] ファイル変更チェック中に2件のエラーが発生しました 
[2025-07-21 17:08:09.118 +09:00 WRN] エラーが発生しました。800ms後にリトライします (試行回数: 3/3) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に2件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.) (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に2件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.) (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
 ---> (Inner Exception #1) System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57<---

   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
[2025-07-21 17:08:09.954 +09:00 WRN] リトライ実行中 (試行回数: 3/3, 遅延: 1600ms) 
[2025-07-21 17:08:10.145 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:08:10.153 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:08:10.183 +09:00 ERR] ファイル変更チェック中に2件のエラーが発生しました 
[2025-07-21 17:08:10.188 +09:00 ERR] 最大リトライ回数に達しました (3回) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に2件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.) (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に2件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.) (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
 ---> (Inner Exception #1) System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57<---

   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
[2025-07-21 17:08:10.227 +09:00 WRN] 処理時間が閾値を超えました: CheckFileUpdates - 98650.1502ms (閾値: 5000ms) 
[2025-07-21 17:08:10.231 +09:00 WRN] 処理時間が閾値を超えました: main_loop - 99208.1214ms (閾値: 5000ms) 
[2025-07-21 17:08:10.234 +09:00 ERR] パフォーマンス監視: エラーが記録されました - ExcelFileException: ファイル更新チェック中にエラーが発生しました:  
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に2件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.) (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に2件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.) (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
 ---> (Inner Exception #1) System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57<---

   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 65
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 92
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 74
   at VacancyImport.Services.ServiceHost.ExecuteBusinessLogicAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 323
   at VacancyImport.Services.ServiceHost.ExecuteAsync(CancellationToken stoppingToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 132
[2025-07-21 17:08:10.257 +09:00 ERR] メインループでエラーが発生しました (連続エラー数: 1) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に2件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.) (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に2件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.) (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\神奈川\やまと\~$【やまと】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
 ---> (Inner Exception #1) System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57<---

   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 65
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 92
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 74
   at VacancyImport.Services.ServiceHost.ExecuteBusinessLogicAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 323
   at VacancyImport.Services.ServiceHost.ExecuteAsync(CancellationToken stoppingToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 132
[2025-07-21 17:08:10.420 +09:00 INF] Start processing HTTP request POST https://auth.worksmobile.com/oauth2/v2.0/token 
[2025-07-21 17:08:10.426 +09:00 INF] Sending HTTP request POST https://auth.worksmobile.com/oauth2/v2.0/token 
[2025-07-21 17:08:10.711 +09:00 INF] Received HTTP response headers after 281.7179ms - 400 
[2025-07-21 17:08:10.715 +09:00 INF] End processing HTTP request after 302.8707ms - 400 
[2025-07-21 17:08:10.724 +09:00 ERR] アクセストークンの取得中にエラーが発生しました 
System.Net.Http.HttpRequestException: Response status code does not indicate success: 400.
   at System.Net.Http.HttpResponseMessage.EnsureSuccessStatusCode()
   at VacancyImport.Services.LineWorksService.GetAccessTokenAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\LineWorksService.cs:line 55
[2025-07-21 17:08:10.730 +09:00 ERR] エラー通知の送信に失敗しました 
System.Net.Http.HttpRequestException: Response status code does not indicate success: 400.
   at System.Net.Http.HttpResponseMessage.EnsureSuccessStatusCode()
   at VacancyImport.Services.LineWorksService.GetAccessTokenAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\LineWorksService.cs:line 55
   at VacancyImport.Services.LineWorksService.SendMessageAsync(Object messageObj) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\LineWorksService.cs:line 169
   at VacancyImport.Services.LineWorksService.SendErrorNotificationAsync(String errorMessage, Int32 errorCount) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\LineWorksService.cs:line 154
[2025-07-21 17:08:30.914 +09:00 INF] システムリソース使用状況: メモリ=57MB, CPUタイム="00:00:04.1718750", スレッド数=21 
[2025-07-21 17:08:30.921 +09:00 INF] 操作パフォーマンス: CheckFileUpdates, 平均=98650.1502ms, 最大=98650.1502ms, 最小=98650.1502ms, 件数=1 
[2025-07-21 17:08:30.927 +09:00 INF] 操作パフォーマンス: main_loop, 平均=99208.1214ms, 最大=99208.1214ms, 最小=99208.1214ms, 件数=1 
[2025-07-21 17:08:30.935 +09:00 INF] 操作パフォーマンス: CalculateFileHash, 平均=7113.777899999999ms, 最大=35395.5038ms, 最小=40.9146ms, 件数=5 
[2025-07-21 17:09:14.702 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:09:16.028 +09:00 INF] ファイルが更新されました: \\192.168.200.20\全社共有\SS予約表\2025年\神奈川\ふじさわ\【ふじさわ】2025年_SS予約表_241122.xlsm 
[2025-07-21 17:09:16.036 +09:00 ERR] ファイル変更チェック中に1件のエラーが発生しました 
[2025-07-21 17:09:16.042 +09:00 WRN] エラーが発生しました。200ms後にリトライします (試行回数: 1/3) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
[2025-07-21 17:09:16.293 +09:00 WRN] リトライ実行中 (試行回数: 1/3, 遅延: 400ms) 
[2025-07-21 17:09:16.488 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:09:16.503 +09:00 ERR] ファイル変更チェック中に1件のエラーが発生しました 
[2025-07-21 17:09:16.510 +09:00 WRN] エラーが発生しました。400ms後にリトライします (試行回数: 2/3) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
[2025-07-21 17:09:16.965 +09:00 WRN] リトライ実行中 (試行回数: 2/3, 遅延: 800ms) 
[2025-07-21 17:09:17.164 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:09:17.172 +09:00 ERR] ファイル変更チェック中に1件のエラーが発生しました 
[2025-07-21 17:09:17.174 +09:00 WRN] エラーが発生しました。800ms後にリトライします (試行回数: 3/3) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
[2025-07-21 17:09:18.016 +09:00 WRN] リトライ実行中 (試行回数: 3/3, 遅延: 1600ms) 
[2025-07-21 17:09:18.226 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:09:18.236 +09:00 ERR] ファイル変更チェック中に1件のエラーが発生しました 
[2025-07-21 17:09:18.240 +09:00 ERR] 最大リトライ回数に達しました (3回) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
[2025-07-21 17:09:18.265 +09:00 WRN] 処理時間が閾値を超えました: CheckFileUpdates - 7510.9845ms (閾値: 5000ms) 
[2025-07-21 17:09:18.269 +09:00 WRN] 処理時間が閾値を超えました: main_loop - 7515.0967ms (閾値: 5000ms) 
[2025-07-21 17:09:18.271 +09:00 ERR] パフォーマンス監視: エラーが記録されました - ExcelFileException: ファイル更新チェック中にエラーが発生しました:  
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 65
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 92
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 74
   at VacancyImport.Services.ServiceHost.ExecuteBusinessLogicAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 323
   at VacancyImport.Services.ServiceHost.ExecuteAsync(CancellationToken stoppingToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 132
[2025-07-21 17:09:18.291 +09:00 ERR] メインループでエラーが発生しました (連続エラー数: 2) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 65
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 92
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 74
   at VacancyImport.Services.ServiceHost.ExecuteBusinessLogicAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 323
   at VacancyImport.Services.ServiceHost.ExecuteAsync(CancellationToken stoppingToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 132
[2025-07-21 17:09:30.931 +09:00 INF] システムリソース使用状況: メモリ=57MB, CPUタイム="00:00:05.1718750", スレッド数=23 
[2025-07-21 17:09:30.944 +09:00 INF] 操作パフォーマンス: CheckFileUpdates, 平均=7510.9845ms, 最大=7510.9845ms, 最小=7510.9845ms, 件数=1 
[2025-07-21 17:09:30.952 +09:00 INF] 操作パフォーマンス: main_loop, 平均=7515.0967ms, 最大=7515.0967ms, 最小=7515.0967ms, 件数=1 
[2025-07-21 17:09:30.965 +09:00 INF] 操作パフォーマンス: CalculateFileHash, 平均=310.45369999999997ms, 最大=1443.0865ms, 最小=24.1597ms, 件数=5 
[2025-07-21 17:10:22.764 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:10:22.791 +09:00 ERR] ファイル変更チェック中に1件のエラーが発生しました 
[2025-07-21 17:10:22.800 +09:00 WRN] エラーが発生しました。200ms後にリトライします (試行回数: 1/3) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
[2025-07-21 17:10:23.057 +09:00 WRN] リトライ実行中 (試行回数: 1/3, 遅延: 400ms) 
[2025-07-21 17:10:23.299 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:10:23.316 +09:00 ERR] ファイル変更チェック中に1件のエラーが発生しました 
[2025-07-21 17:10:23.319 +09:00 WRN] エラーが発生しました。400ms後にリトライします (試行回数: 2/3) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
[2025-07-21 17:10:23.787 +09:00 WRN] リトライ実行中 (試行回数: 2/3, 遅延: 800ms) 
[2025-07-21 17:10:23.989 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:10:24.014 +09:00 ERR] ファイル変更チェック中に1件のエラーが発生しました 
[2025-07-21 17:10:24.017 +09:00 WRN] エラーが発生しました。800ms後にリトライします (試行回数: 3/3) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
[2025-07-21 17:10:24.847 +09:00 WRN] リトライ実行中 (試行回数: 3/3, 遅延: 1600ms) 
[2025-07-21 17:10:25.042 +09:00 ERR] ファイル変更チェックの処理中にエラーが発生しました 
System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
[2025-07-21 17:10:25.058 +09:00 ERR] ファイル変更チェック中に1件のエラーが発生しました 
[2025-07-21 17:10:25.066 +09:00 ERR] 最大リトライ回数に達しました (3回) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
[2025-07-21 17:10:25.131 +09:00 WRN] 処理時間が閾値を超えました: CheckFileUpdates - 6813.8567ms (閾値: 5000ms) 
[2025-07-21 17:10:25.134 +09:00 WRN] 処理時間が閾値を超えました: main_loop - 6816.7436ms (閾値: 5000ms) 
[2025-07-21 17:10:25.151 +09:00 ERR] パフォーマンス監視: エラーが記録されました - ExcelFileException: ファイル更新チェック中にエラーが発生しました:  
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 65
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 92
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 74
   at VacancyImport.Services.ServiceHost.ExecuteBusinessLogicAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 323
   at VacancyImport.Services.ServiceHost.ExecuteAsync(CancellationToken stoppingToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 132
[2025-07-21 17:10:25.175 +09:00 ERR] メインループでエラーが発生しました (連続エラー数: 3) 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 65
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 92
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 74
   at VacancyImport.Services.ServiceHost.ExecuteBusinessLogicAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 323
   at VacancyImport.Services.ServiceHost.ExecuteAsync(CancellationToken stoppingToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 132
[2025-07-21 17:10:25.193 +09:00 INF] Start processing HTTP request POST https://auth.worksmobile.com/oauth2/v2.0/token 
[2025-07-21 17:10:25.196 +09:00 INF] Sending HTTP request POST https://auth.worksmobile.com/oauth2/v2.0/token 
[2025-07-21 17:10:25.256 +09:00 INF] Received HTTP response headers after 58.0104ms - 400 
[2025-07-21 17:10:25.258 +09:00 INF] End processing HTTP request after 66.7897ms - 400 
[2025-07-21 17:10:25.260 +09:00 ERR] アクセストークンの取得中にエラーが発生しました 
System.Net.Http.HttpRequestException: Response status code does not indicate success: 400.
   at System.Net.Http.HttpResponseMessage.EnsureSuccessStatusCode()
   at VacancyImport.Services.LineWorksService.GetAccessTokenAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\LineWorksService.cs:line 55
[2025-07-21 17:10:25.265 +09:00 ERR] エラー通知の送信に失敗しました 
System.Net.Http.HttpRequestException: Response status code does not indicate success: 400.
   at System.Net.Http.HttpResponseMessage.EnsureSuccessStatusCode()
   at VacancyImport.Services.LineWorksService.GetAccessTokenAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\LineWorksService.cs:line 55
   at VacancyImport.Services.LineWorksService.SendMessageAsync(Object messageObj) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\LineWorksService.cs:line 169
   at VacancyImport.Services.LineWorksService.SendErrorNotificationAsync(String errorMessage, Int32 errorCount) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\LineWorksService.cs:line 154
[2025-07-21 17:10:25.275 +09:00 ERR] BackgroundService failed 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 65
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 92
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 74
   at VacancyImport.Services.ServiceHost.ExecuteBusinessLogicAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 323
   at VacancyImport.Services.ServiceHost.ExecuteAsync(CancellationToken stoppingToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 132
   at VacancyImport.Services.ServiceHost.ExecuteAsync(CancellationToken stoppingToken)
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
[2025-07-21 17:10:25.298 +09:00 FTL] The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted. 
VacancyImport.Exceptions.ExcelFileException: ファイル更新チェック中にエラーが発生しました: 
 ---> System.AggregateException: One or more errors occurred. (ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.))
 ---> System.AggregateException: ファイル変更チェック中に1件のエラーが発生しました (The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.)
 ---> System.IO.IOException: The process cannot access the file '\\192.168.200.20\全社共有\SS予約表\2025年\埼京B\こしがや\~$【こしがや】2025年_SS予約表_241122.xlsm' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)
   at VacancyImport.Services.ExcelService.CalculateFileHashAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 365
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__1>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 133
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.ParallelProcessor.<>c__DisplayClass0_1`2.<<ProcessParallelAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 57
   --- End of inner exception stack trace ---
   at VacancyImport.Utilities.ParallelProcessor.ProcessParallelAsync[TInput,TOutput](IEnumerable`1 items, Func`3 processFunc, Int32 maxDegreeOfParallelism, ILogger logger, String operationName, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\ParallelProcessor.cs:line 87
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)
   at VacancyImport.Services.ExcelService.<>c.<CheckFileUpdatesAsync>b__10_2(Task`1 t) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 149
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 110
   --- End of inner exception stack trace ---
   at VacancyImport.Services.ExcelService.<>c__DisplayClass10_0.<<CheckFileUpdatesAsync>b__0>d.MoveNext() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 163
--- End of stack trace from previous location ---
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 47
   at VacancyImport.Utilities.RetryPolicy.ExecuteWithRetryAsync[T](Func`1 func, Int32 retryCount, Int32 initialDelay, Int32 maxDelay, ILogger logger, CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Utilities\RetryPolicy.cs:line 65
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync(String filePath) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 92
   at VacancyImport.Services.ExcelService.CheckFileUpdatesAsync() in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ExcelService.cs:line 74
   at VacancyImport.Services.ServiceHost.ExecuteBusinessLogicAsync(CancellationToken cancellationToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 323
   at VacancyImport.Services.ServiceHost.ExecuteAsync(CancellationToken stoppingToken) in C:\VacancyImport\vacancy_import_v2\src\VacancyImport\Services\ServiceHost.cs:line 132
   at VacancyImport.Services.ServiceHost.ExecuteAsync(CancellationToken stoppingToken)
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
[2025-07-21 17:10:25.319 +09:00 INF] Application is shutting down... 
[2025-07-21 17:10:25.322 +09:00 INF] ⏹️ 予約管理システム連携サービス の停止処理を開始します... 
[2025-07-21 17:10:30.930 +09:00 INF] システムリソース使用状況: メモリ=57MB, CPUタイム="00:00:06.2031250", スレッド数=20 
[2025-07-21 17:10:30.943 +09:00 INF] 操作パフォーマンス: CheckFileUpdates, 平均=6813.8567ms, 最大=6813.8567ms, 最小=6813.8567ms, 件数=1 
[2025-07-21 17:10:30.955 +09:00 INF] 操作パフォーマンス: main_loop, 平均=6816.7436ms, 最大=6816.7436ms, 最小=6816.7436ms, 件数=1 
[2025-07-21 17:10:30.958 +09:00 INF] 操作パフォーマンス: CalculateFileHash, 平均=27.78425ms, 最大=30.3614ms, 最小=26.5206ms, 件数=4 
[2025-07-21 17:10:55.331 +09:00 INF] 停止処理が完了しました 
[2025-07-21 17:10:55.346 +09:00 INF] 🔄 予約管理システム連携サービス が正常に停止しました 
[2025-07-21 17:10:55.363 +09:00 INF] 📝 ログをフラッシュしています... 